var aiDebugging=false;
var aiCommonParams={report:{},server:{}};
function loadAIReport(c,e,d,a){a||(a="HTML");d||(d="_self");a=configParamElements(e,a);var b=document.getElementById("aireport-dummy-form");null==b?(b=document.createElement("form"),b.setAttribute("id","aireport-dummy-form"),document.body.appendChild(b)):b.innerHTML="";var f="POST",g=null;e.agent&&("GET"===e.agent.method&&(f="GET"),g=e.agent.windowFeatures);b.setAttribute("action",c);b.setAttribute("method",f);(e="_new"===d)?b.setAttribute("target","aireport_win"):b.setAttribute("target",d);var h;
b.innerHTML=a;e&&(h=g?window.open("","aireport_win",g):window.open("","aireport_win"));aiDebugging&&window.console&&(window.console.log("\n\n"+f+" "+c),e&&window.console.log("windowFeatures: "+g),window.console.log(b.innerHTML));b.submit();h&&window.focus&&h.focus()}
function configParamElements(c,e){var d="<input type='hidden' name='reportMode' value='"+e+"'>\n",a;if(c.user){var b=c.user;for(a in b)d+="<input type='hidden' name='"+a+"' value='"+escapeValue(b[a])+"'>\n"}var b=[],f;if(c.report){var g=c.report;for(a in g)f=f?f+(","+a+":"+g[a]):a+":"+g[a],b.push(a)}g=aiCommonParams.report;for(a in g)f&&-1!=inArray(a,b)||(f=f?f+(","+a+":"+g[a]):a+":"+g[a]);f&&(f=escapeValue(f),d+="<input type='hidden' name='reportParams' value='"+f+"'>\n");b.length=0;if(c.server)for(a in f=
c.server,f)d+="<input type='hidden' name='"+a+"' value='"+escapeValue(f[a])+"'>\n",b.push(a);g=aiCommonParams.server;for(a in g)-1==inArray(a,b)&&(d+="<input type='hidden' name='"+a+"' value='"+escapeValue(g[a])+"'>\n");return d}var replExp=/'/g;function escapeValue(c){return"string"!=typeof c?c:-1==c.indexOf("'")?c:c.replace(replExp,"&#039;")}function inArray(c,e,d){var a;if(e)for(a=e.length,d=d?0>d?Math.max(0,a+d):d:0;d<a;d++)if(d in e&&e[d]===c)return d;return-1}var replExp2=/\f/g;
function convertToParameters(c,e){e||(e={});var d,a,b=0;for(a=c.indexOf(":");-1!=a;)if(d=c.substring(b,a),"'"===c.charAt(a+1)?(b=c.indexOf("'",a+2),a=c.substring(a+2,b),-1!=a.indexOf("\f")&&(a=a.replace(replExp2,"'")),b++):(b=c.indexOf(",",a+1),-1==b&&(b=c.length),a=c.substring(a+1,b)),e[d]=a,","===c.charAt(b))a=c.indexOf(":",++b);else break;return e};